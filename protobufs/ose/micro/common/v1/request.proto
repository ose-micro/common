syntax = "proto3";

package ose.micro.common.v1;

import "google/protobuf/struct.proto";

option go_package = "github.com/ose-micro/common/gen/go/ose/micro/common/v1;commonv1";

enum FilterOp {
  FILTER_OP_UNSPECIFIED = 0;
  FILTER_OP_EQ = 1;
  FILTER_OP_NE = 2;
  FILTER_OP_GT = 3;
  FILTER_OP_GTE = 4;
  FILTER_OP_LT = 5;
  FILTER_OP_LTE = 6;
  FILTER_OP_IN = 7;
  FILTER_OP_NIN = 8;
  FILTER_OP_REGEX = 9;
}

enum AggregationType {
  AGGREGATION_TYPE_UNSPECIFIED = 0;
  AGGREGATION_TYPE_SUM = 1;
  AGGREGATION_TYPE_AVG = 2;
  AGGREGATION_TYPE_COUNT = 3;
  AGGREGATION_TYPE_MIN = 4;
  AGGREGATION_TYPE_MAX = 5;
}

enum SortOrder {
  SORT_ORDER_UNSPECIFIED = 0;
  SORT_ORDER_ASC = 1;
  SORT_ORDER_DESC = 2;
}

enum ComputedOperator {
  COMPUTED_OPERATOR_UNSPECIFIED = 0;
  COMPUTED_OPERATOR_MULTIPLY = 1;
  COMPUTED_OPERATOR_ADD = 2;
  COMPUTED_OPERATOR_DIVIDE = 3;
  COMPUTED_OPERATOR_SUBTRACT = 4;
  COMPUTED_OPERATOR_WEEK = 5;
  COMPUTED_OPERATOR_YEAR = 6;
  COMPUTED_OPERATOR_MONTH = 7;
  COMPUTED_OPERATOR_DAY_OF_MONTH = 8;
  COMPUTED_OPERATOR_TO_UPPER = 9;
  COMPUTED_OPERATOR_TO_LOWER = 10;
  COMPUTED_OPERATOR_CONCAT = 11;
  COMPUTED_OPERATOR_SUBSTR = 12;
  COMPUTED_OPERATOR_DATE_TRUNC = 13;
  COMPUTED_OPERATOR_IF_NULL = 14;
}

message Filter {
  string field = 1;
  FilterOp op = 2;
  string value = 3;
}

message Aggregation {
  AggregationType type = 1;
  string field = 2;
  string as = 3;
}

message SortOption {
  string field = 1;
  SortOrder order = 2;
}

message ComputedField {
  string name = 1;
  ComputedOperator operator = 2;
  repeated string operands = 3;
}

message FacetQuery {
  string name = 1;
  repeated Filter filters = 2;
  repeated string group_by = 3;
  repeated Aggregation aggregations = 4;
  repeated SortOption sort = 5;
  repeated ComputedField computed_fields = 6;
  int64 skip = 7;
  int64 limit = 8;
}

message Request {
  repeated FacetQuery facets = 1;
}

message Result {
  map<string, google.protobuf.Value> data = 1;
}

